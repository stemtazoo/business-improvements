# Software Requirements Specification (SRS)

## 1. 目的

本ドキュメントは、**TDnet 決算短信 XBRL Downloader** に関する
機能要件・非機能要件・制約条件を明確化し、
今後の保守・拡張・引き継ぎを容易にすることを目的とする。

---

## 2. 対象システム概要

* TDnet（適時開示情報閲覧サービス）から
  決算短信の XBRL ファイルを自動取得する Python スクリプト
* ブラウザ自動操作には Playwright を使用する
* 設定は外部の `config.yaml` により管理する

---

## 3. 用語定義

| 用語          | 説明                       |
| ----------- | ------------------------ |
| TDnet       | 東京証券取引所 適時開示情報閲覧サービス     |
| 決算短信        | 上場企業が開示する決算情報（四半期・通期を含む） |
| XBRL        | 財務情報を記述するための XML ベース言語   |
| ticker      | 証券コード                    |
| config.yaml | 本システムの設定ファイル             |

---

## 4. 想定利用者

* 個人投資家
* 社内の財務・経営分析担当者
* Python を用いた業務自動化担当者

---

## 5. 機能要件

### 5.1 入力要件

* システムは `config.yaml` から以下の情報を読み込むこと

  * 証券コード（ticker）のリスト
  * 検索開始日（YYYYMMDD）
  * ダウンロード先ディレクトリ
  * Playwright の実行設定（headless, wait時間）

---

### 5.2 処理要件

* ticker ごとに TDnet の検索機能を使用して情報を取得すること
* 検索結果から以下の条件を満たす行のみを抽出すること

  * 証券コードが一致していること
  * 表題に以下のいずれかを含むこと

    * 決算短信
    * 四半期決算短信
    * 通期決算短信
* 複数件該当する場合は、**最新の 1 件のみ**を対象とすること
* 対象行に存在する XBRL リンクをクリックし、ファイルを取得すること

---

### 5.3 出力要件

* ダウンロードした XBRL（ZIP）ファイルをローカルに保存すること
* ファイル名は以下の形式とすること

```
{ticker}_{TDnet が提示する元ファイル名}.zip
```

---

### 5.4 エラー処理要件

* 決算短信が存在しない ticker はスキップすること
* 一部 ticker の処理失敗によって、全体処理が中断しないこと
* タイムアウトや取得失敗はログおよび標準出力に記録すること

---

## 6. 非機能要件

### 6.1 動作環境

* Python 3.9 以上
* Windows / macOS / Linux

---

### 6.2 性能・運用

* TDnet サーバーに過剰な負荷を与えないこと
* ticker 処理間に適切な待ち時間を設けること
* 無人実行（ユーザー操作不要）で動作可能であること

---

### 6.3 保守性・拡張性

* 設定変更はコード修正なしで行えること
* 将来的な機能追加（PDF フォールバック、XBRL 解析等）を考慮した構成とすること

---

## 7. 制約事項

* TDnet は公式 API を提供していない
* Web UI の変更により、本システムが動作しなくなる可能性がある
* 商用利用する場合は、利用規約を確認する必要がある

---

## 8. 想定される拡張

* ダウンロード済みファイルのスキップ処理
* 決算短信が存在しない場合の PDF ダウンロード
* ZIP 自動解凍および XBRL データの解析
* EDINET / e-Stat など他データソースとの連携

---

## 9. 改訂履歴

| 日付         | 内容   | 備考 |
| ---------- | ---- | -- |
| 2026-01-29 | 初版作成 |    |
